# Vision Transformer MNIST 高效消融实验报告

**实验时间**: 20250609_101146
**设备**: cuda
**实验策略**: 高效消融设计，减少实验数量从243个到34个

## 实验概览

- **总实验数**: 34
- **实验组数**: 10
- **节省比例**: 95.3%
- **学习率调整策略**: 根据batch size自动调整 (缩放因子: 0.5)

## 最佳实验结果

- **实验名称**: embed_dim_ablation_embed_dim_128
- **实验组**: embed_dim_ablation
- **最佳准确率**: 99.37%
- **参数数量**: 1,199,882
- **训练时间**: 563.7s
- **参数效率**: 82.816

### 最佳配置

```json
{
  "patch_size": 7,
  "num_layers": 6,
  "num_heads": 4,
  "batch_size": 64,
  "dropout": 0.1,
  "embed_dim": 128
}
```

## 分组实验结果

### baseline

实验数量: 1

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| baseline | 98.86 | 305,034 | 582.2 | 0.000300 | 324.095 |

### patch_size_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| patch_size_ablation_patch_size_4 | 99.03 | 305,034 | 589.2 | 0.000300 | 324.652 |
| patch_size_ablation_patch_size_7 | 98.92 | 305,034 | 592.3 | 0.000300 | 324.292 |
| patch_size_ablation_patch_size_14 | 98.92 | 313,674 | 586.7 | 0.000300 | 315.359 |

### depth_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| depth_ablation_num_layers_9 | 99.01 | 454,986 | 649.7 | 0.000300 | 217.611 |
| depth_ablation_num_layers_6 | 98.88 | 305,034 | 567.3 | 0.000300 | 324.161 |
| depth_ablation_num_layers_3 | 98.72 | 155,082 | 478.2 | 0.000300 | 636.566 |

### heads_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| heads_ablation_num_heads_8 | 99.00 | 305,034 | 556.1 | 0.000300 | 324.554 |
| heads_ablation_num_heads_4 | 98.90 | 305,034 | 530.6 | 0.000300 | 324.226 |
| heads_ablation_num_heads_2 | 98.74 | 305,034 | 566.6 | 0.000300 | 323.702 |

### embed_dim_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| embed_dim_ablation_embed_dim_128 | 99.37 | 1,199,882 | 563.7 | 0.000300 | 82.816 |
| embed_dim_ablation_embed_dim_64 | 98.92 | 305,034 | 570.0 | 0.000300 | 324.292 |
| embed_dim_ablation_embed_dim_32 | 97.65 | 78,794 | 563.9 | 0.000300 | 1239.308 |

### batch_size_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| batch_size_ablation_batch_size_256 | 98.84 | 305,034 | 383.7 | 0.000600 | 324.029 |
| batch_size_ablation_batch_size_64 | 98.68 | 305,034 | 561.6 | 0.000300 | 323.505 |
| batch_size_ablation_batch_size_1024 | 98.17 | 305,034 | 370.9 | 0.001000 | 321.833 |

### learning_rate_ablation

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| learning_rate_ablation_learning_rate_0.001 | 99.11 | 305,034 | 567.8 | 0.001000 | 324.915 |
| learning_rate_ablation_learning_rate_0.0003 | 98.81 | 305,034 | 565.9 | 0.000300 | 323.931 |
| learning_rate_ablation_learning_rate_0.0001 | 98.00 | 305,034 | 567.8 | 0.000100 | 321.276 |

### orthogonal_design

实验数量: 9

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| orthogonal_design_7 | 98.53 | 163,722 | 362.1 | 0.001000 | 601.813 |
| orthogonal_design_5 | 98.39 | 78,794 | 565.0 | 0.001000 | 1248.699 |
| orthogonal_design_3 | 98.31 | 1,794,698 | 694.3 | 0.001000 | 54.778 |
| orthogonal_design_9 | 98.10 | 121,226 | 595.5 | 0.000300 | 809.232 |
| orthogonal_design_4 | 97.73 | 605,066 | 360.6 | 0.000300 | 161.520 |
| orthogonal_design_8 | 97.53 | 1,217,162 | 331.8 | 0.000100 | 80.129 |
| orthogonal_design_2 | 97.38 | 305,034 | 458.5 | 0.000300 | 319.243 |
| orthogonal_design_6 | 94.45 | 454,986 | 402.1 | 0.000100 | 207.589 |
| orthogonal_design_1 | 90.17 | 40,682 | 475.6 | 0.000100 | 2216.459 |

### extreme_configs

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| maximal_model | 99.09 | 1,794,698 | 970.2 | 0.000300 | 55.213 |
| balanced_model | 98.57 | 305,034 | 384.4 | 0.000600 | 323.144 |
| minimal_model | 97.42 | 45,002 | 358.9 | 0.000600 | 2164.793 |

### efficiency_focused

实验数量: 3

| 实验名称 | 准确率(%) | 参数数量 | 训练时间(s) | 学习率 | 参数效率 |
|----------|-----------|----------|-------------|--------|----------|
| memory_efficient | 98.88 | 313,674 | 565.6 | 0.000300 | 315.232 |
| fast_inference | 98.54 | 163,722 | 337.8 | 0.000600 | 601.874 |
| parameter_efficient | 96.80 | 78,794 | 356.8 | 0.000600 | 1228.520 |

## 结论和建议

基于高效消融实验的结果，我们得出以下结论：

### 关键因子效应

- **embed_dim**: 效应大小 1.72%, 最佳值 128
- **learning_rate**: 效应大小 1.11%, 最佳值 0.001
- **batch_size**: 效应大小 0.67%, 最佳值 256
- **num_layers**: 效应大小 0.29%, 最佳值 9
- **num_heads**: 效应大小 0.26%, 最佳值 8
- **patch_size**: 效应大小 0.11%, 最佳值 4

### 实验设计效果

- 通过高效消融设计，我们用34个实验获得了接近全因子实验的信息
- 节省了95.3%的计算资源
- 正交设计和单因子消融有效识别了关键参数和交互效应

### 推荐配置

根据不同需求，推荐以下配置：

- **最高准确率**: embed_dim_ablation_embed_dim_128 (99.37%)
- **最高参数效率**: orthogonal_design_1 (2216.459)
- **最快训练**: orthogonal_design_8 (331.8s)
